## <center><font color='yellowgreen'> Модель машинного обучения для банка для определения потенциальных клиентов для открытия депозитного счета. </font></center>

**Банк поставил перед нами задачу проанализировать анкетные данные клиентов и итоги маркетинговых кампаний и определить, какими характеристиками обладают клиенты, которые имеют депозитные счета и какие факторы влияют на отсутствие депозита у клиентов.**

### <center><font color = 'springblue'>**Цель проекта**</font></center>
**Создать качественную модель ML, которая будет определять потенциальных клиентов для открытия депозитного счета.**

#### **Данные, которые предоставил нам банк:**

Факторы о клиентах банка:
* age (возраст);
* job (сфера занятости);
* marital (семейное положение);
* education (уровень образования);
* default (имеется ли просроченный кредит);
* housing (имеется ли кредит на жильё);
* loan (имеется ли кредит на личные нужды);
* balance (баланс).

Факторы, относящиеся к текущей и прошлой маркетинговым кампаниям:
* contact (тип контакта с клиентом);
* month (месяц, в котором был последний контакт);
* day (день, в который был последний контакт);
* duration (продолжительность контакта в секундах).
* campaign (количество контактов с этим клиентом в течение текущей кампании);
* pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
* previous (количество контактов до текущей кампании)
* poutcome (результат прошлой маркетинговой кампании).

Целевая переменная  - **deposit**, которая определяет, согласится ли клиент открыть депозит в банке. Её мы и будем предсказывать.

### <center><font color = 'springblue'>**Этапы проекта**</font></center>
#### **Этап 1. Знакомство с данными, очистка от пропусков и выбросов**
  - ***Признак balance***\
  Мы обнаружили 25 пропусков в признаке balance, а также строковое значение объектов признака, поэтому сделали преобразование и заменили пропуски медианой.\
  Данный признак показал колоссальное количество выбросов, от которых мы смогли избавиться с помощью метода Тьюки;
  - ***Признаки job и education***\
  содержали неизвестную категорию unknown в небольшом количестве и мы заменили ее модальным значением.

#### **Этап 2. Разведывательный анализ EDA**

   * ***Целевой признак deposit***\
   мы проверили на сбалансированность классов, так как решаем задачу классификации, и сделали вывод о достаточной сбалансированности и отсутствии необходимости сэмплирования.

   * ***Побробное изучение и визуализация распределения числовых признаков***\
   Исследование числовых признаков age, balance, day, duration,	campaign, pdays, previous выявило некоторые определяющие характеристики клиентов с депозитными счетами и особенности маркетинговых кампаний.
  
  * ***Побробное изучение и визуализация распределения категориальных признаков***\
   Исследование категориальных признаков job,	marital,
education, default, housing, loan, contact, month, poutcome определило ключевые моменты в характеристиках клиентов, имеющих депозит, основные факторы, влияющие на принятие решения об открытии счета.

* ***Создание новых категориальных признаков, взаимосвязи целевой переменной одновременно с несколькими факторами***
  - мы преобразовали в категориальные признаки age и balance и изучили их категории в разрезе наличия депозита, что подтвердило предыдущие выводы,
  - детально изучили влияние таких признаков, как семейное положение, образование, сфера деятельности и баланс, на целевой признак deposit.

#### **Этап 3. Подготовка признаков для моделирования: кодирование, трасформация и отбор**
* ***Кодирование*** признаков происходило по трем критериям: порядковые признаки, номинальные и бинарные. После всех кодирований наш датасет состоял из 45 факторов и целевого признака.
Для того, чтобы отобрать наиболее значимые признаки для моделирования, мы провели корреляционный анализ.
* ***Отбор признаков*** был произведен с помощью метода SelectKBest на основе дисперсионного анализа ANOVA, по итогу мы отобрали наиболее значимых 20 признаков из 45.
* ***Трансформация признаков***\
Известно, что большинство моделей требует на вход нормализованные/стандартизованные данных. Для наших числовых признаков мы применили Power Transformer, который преобразовал признаки до очертаний гауссовского распределения.

#### **Этап 4. Простые модели машинного обучения для задачи бинарной классификации**

Данный этап заключался в создании простых моделей классификации, потом с помощью фреймворка Optuna мы подбирали наилучшие гиперпараметры для наших моделей и уже на основе их вновь моделировали.\
**Шаги:**
* Логистическая регрессия
* Оптимизация гиперпараметров для логистической регрессии
* Создание логистической регрессии на наилучших гиперпараметрах
* Алгоритм решающего дерева
* Оптимизация гиперпараметров для алгоритма решающего дерева
* Создание алгоритма решающего дерева на наилучших гиперпараметрах

#### **Этап 5. Ансамблевые модели машинного обучения для классификации**

Здесь мы обратились к более сложным моделям, но также и более эффективным по качеству.\
**Шаги:**
* Алгоритм случайного леса
* Оптимизация гиперпараметров для алгоритма случайного леса и построение модели на их основе
* Алгоритм градиентного бустинга
* Классический градиентный бустинг
* Стекинг\
Финальной стала стекинговая модель: в качестве базовых были использованы созданные ранее модели логистической регрессии, случайного леса и классического градиентного бустинга, а метамодель - логистическая регрессия.

#### **Этап 6. Подведение итогов проекта: сравнительный анализ качества всех моделей, выводы по исследованию всех факторов и рекомендации.**

- Мы выявили основные характеристики клиентов, у которых имеется депозитный счет;
- Написали рекомендации, на какие анкетные данные клиентов банку следует обратить внимание в следующей маркетинговой кампании;
- Определили ключевые факторы, которые влияют на целевую переменную в моделировании;
- Выбрали лучшую модель по итогам значений метрик.

<font color='orange'>ПРИМЕЧАНИЕ</font> После каждого этапа проекта вы увидите подробные выводы. А по завершению вас ждет заключение, в котором будет обобщающий итог по всему проекту.

А теперь переходим по ссылке и знакомимся с проектом [здесь](https://github.com/YaroslavaVob/DataScience_skillfactory/blob/main/Project_4_Classification/Project_4_ML.ipynb).


### Какие библиотеки использовались для анализа:
<font color = 'springblue'>pandas</font>\
<font color = 'springblue'>numpy</font>\
<font color = 'springblue'>sklearn</font>\
<font color = 'springblue'>optuna</font>\
<font color = 'springblue'>matplotlib</font>\
<font color = 'springblue'>seaborn</font>\
<font color = 'springblue'>catboost</font>




**Проект создан на базе языка Python в Jupyter Notebook.**

Автор: Ярослава Вобшаркян\
(студент школы SkillFactory по курсу Data Science)

