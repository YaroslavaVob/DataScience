## <center><font color='darkblue'> Модель машинного обучения, предсказывающая длительность поездки в такси в пределах города Нью-Йорк в 2016 году. </font></center>

**Перед нами была поставлена задача разработать алгоритм, способный прогнозировать стоимость поездки. Наша часть состояла в разработке тарифа: совокупность факторов, влиящих на продолжительность пути в такси из точки A в точку В.**

Данные, которые нам предоставили: 1458644 поездок, описанных 11 признаками:
* id - уникальный идентификатор поездки
* vendor_id - уникальный идентификатор поставщика (таксопарка), связанного с записью поездки
* pickup_datetime - дата и время, когда был включен счетчик поездки
* dropoff_datetime - дата и время, когда счетчик был отключен
* pickup_longitude -  долгота, на которой был включен счетчик
* pickup_latitude - широта, на которой был включен счетчик
* dropoff_longitude - долгота, на которой счетчик был отключен
* dropoff_latitude - широта, на которой счетчик был отключен
* passenger_count - количество пассажиров в транспортном средстве (введенное водителем значение)
* store_and_fwd_flag - флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику. Y - хранить и пересылать, N - не хранить и не пересылать поездку.\
**Целевой признак:**
* trip_duration - продолжительность поездки в секундах.

Подзадачи проекта:
1. Дополнить предоставленный набор данных сведениями из внешних  источников информации.
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели.
3. Исследовать предоставленные данные и выявить закономерности.
4. Построить несколько моделей и выбрать из них наилучшую по заданной метрике RMSLE.

### <center><font color = 'springblue'>**Этапы проекта**</font></center>
#### **Расширение набора данных дополнительными сведениями из внешних источников и генерация новых признаков.**
- мы извлекли дополнительные географические данные из OSMR, информацию о праздничных днях и различных погодных характеристик за указанный период.
- добавили и сгенерировавли новые признаки:
  * час начала поездки (pickup_hour), 
  * день недели, в которую совершена поездка (pickup_day_of_week), 
  * признак рабочих и праздничных дней (pickup_holiday), 
  * кратчайшее дорожное расстояние пути согласно OSRM (total_distance), 
  * предполагаемое наименьшее время поездки согласно OSRM (total_travel_time), 
  * количество дискретных шагов водителя согласно OSRM (number_of_steps), 
  * расстояние пути по Хаверсину (haversine_distance), 
  * направление движения (direction), 
  * температура в день поездки (temperature),
  * видимость на улице (visibility),
  * средняя скорость ветра (wind speed),
  * количество осадков (precip),
  * погодные явления (events).
- провели кластеризацию по географическим координатам;
- анализ целевого признака показал аномальные выбросы, которые мы исключили из набора данных,
- очистили данные от пропуков, образованных в итоге Feature Engineering,
- также мы удалили неинформативные и избыточные признаки, после Feature engineering;

#### **Расширенный анализ данных с использованием визуализации.**
- на данном этапе мы выявили, что некоторые признаки особо не влиют на продолжительность поездки, например, каким таксопарком пользуется клиент, или показывают минимальную разницу, так графики распределения дней недели и зависимости продолжительности поездки от дня недели особо не отличаются, а вот час поездки точно влиет на длительность поездки, как и температура за окном, 
- конечно, определяющими факторами продолжительности в пути являются точки начала и завершения поездки - географические координаты, согласно нашей кластеризации 8 из 10 районов вошли в пределы города Нью-Йорк.

#### **Подготовка к моделировани: кодирование, трансформация и отбор.**
- после анализа данных мы приступили к подготовке датасета к подаче алгоритму: закодировали категориальные признаки, провели масшабирование и отобрали 25 наиболее значимых согласно коэффициенту корреляции Пирсона (линейной зависимости с целевой переменной).
- набор данных мы раздели по методу hold-out: тренировочный 67% и валидационный 33%.

#### **Построение простых моделей регрессии**
- линейная регрессия,
- полиномиальная регрессия,
- полиномиальная регрессия с L2-регуляризацией (ограничение длины вектора весов),
- алгоритм дерева решений и поиск оптимальной глубины.

#### **Построение ансамблевых моделей**
- алгоритм случайного леса,
- классический градиентный бустинг над деревьями решений,
- экстремальный градиентный бустинг.

Именно модели градиентного бустинга показали лучшие результаты выбранной метрики RMSLE.
По итогу, через атрибуты моделей градиентного бустинга мы изучили коэффициенты значимости отобранных признаков в построении модели, топовые списки классического и экстремального бустинга отличаются значениями коэффициентов, но определяют практически одинаково факторы, которые наиболее значимо влияют на прогноз продолжительсти поездки в такси.

Модели градиентного бустинга в большинстве случаев ошибаются на 1.8 минуты в своих предсказаниях, что говорит о хорошем качестве этих моделей и их можно использовать для прогноза новых данных.



А теперь переходим по ссылке и знакомимся с проектом [здесь](https://github.com/YaroslavaVob/DataScience_skillfactory/blob/main/Project_4_Classification/Project_4_ML.ipynb).


### Какие библиотеки использовались для анализа:
<font color = 'springblue'>pandas</font>\
<font color = 'springblue'>numpy</font>\
<font color = 'springblue'>sklearn</font>\
<font color = 'springblue'>scipy</font>\
<font color = 'springblue'>matplotlib</font>\
<font color = 'springblue'>seaborn</font>\
<font color = 'springblue'>gxboost</font>




**Проект создан на базе языка Python в Jupyter Notebook.**

Автор: Ярослава Вобшаркян\
(студент школы SkillFactory по курсу Data Science)

